# PDFPlumber 表格 BBox 分析报告

## 文档信息

- **PDF文件**: 鄂尔多斯市政府网站群集约化平台升级改造项目.pdf
- **页面高度**: 842.0pt (A4标准)
- **提取策略**: , 
- **总页数**: 31页
- **总表格数**: 30

## 关键发现

### 1. 跨页坐标问题

PDFPlumber检测到的表格bbox包含**跨页累积坐标**：
- **原因**: PDF底层存储的线段坐标本身就是跨页的（从DOCX转换时产生）
- **现象**: 可能为负数，可能超过页面高度
- **影响**: 如果直接使用raw_bbox提取文本，会提取到其他页的内容（包括页码标记如）

### 2. 跨页表格识别

通过x坐标范围相同，可以判断是否为同一跨页表格：
- **第4-23页**: x=[33.6, 561.1]，同一个跨页表格（共20页）
- **第24-27页**: x=[33.6, 561.1] 或 x=[99.0, 561.1]，另一组跨页表格

### 3. 解决方案

**保留两个bbox**：
1. : 原始跨页bbox（保留完整几何信息，用于跨页判断）
2. : 裁剪到当前页面的bbox（用于文本提取）



---

## 详细表格列表

| 页码 | 表格# | 原始BBox (x0, y0, x1, y1) | 裁剪后BBox | 跨页? | 跨度(页) | 页面范围 |
|------|-------|---------------------------|------------|-------|----------|----------|
| 2 | 1 | (55.5, 397.0, 554.8, 408.4) | (55.5, 397.0, 554.8, 408.4) | ❌ | 0.01 | 2 |
| 3 | 1 | (33.6, 594.2, 561.1, 729.8) | (33.6, 594.2, 561.1, 729.8) | ❌ | 0.16 | 3 |
| 4 | 1 | (33.6, 127.2, 561.1, 5962.1) | (33.6, 127.2, 561.1, 842.0) | ✅ | 6.93 | 4-10 |
| 5 | 1 | (33.6, -638.0, 561.1, 5177.0) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.91 | 5-10 |
| 6 | 1 | (33.6, -1423.0, 561.1, 4392.0) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.91 | 5-10 |
| 7 | 1 | (33.6, -2208.0, 561.1, 3607.0) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.91 | 5-10 |
| 8 | 1 | (33.6, -2993.0, 561.1, 2822.0) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.91 | 5-10 |
| 9 | 1 | (33.6, -3778.1, 561.1, 2037.0) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.91 | 5-10 |
| 10 | 1 | (33.6, -4563.1, 561.1, 1251.9) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.91 | 5-10 |
| 11 | 1 | (33.6, -5348.1, 561.1, 3184.5) | (33.6, 0.0, 561.1, 842.0) | ✅ | 10.13 | 5-13 |
| 12 | 1 | (33.6, -318.1, 561.1, 2399.5) | (33.6, 0.0, 561.1, 842.0) | ✅ | 3.23 | 12-13 |
| 13 | 1 | (33.6, -1103.1, 561.1, 1614.4) | (33.6, 0.0, 561.1, 842.0) | ✅ | 3.23 | 12-13 |
| 14 | 1 | (33.6, -1888.1, 561.1, 829.4) | (33.6, 0.0, 561.1, 829.4) | ✅ | 3.23 | 12-14 |
| 15 | 1 | (33.6, -2673.2, 561.1, 2684.5) | (33.6, 0.0, 561.1, 842.0) | ✅ | 6.36 | 12-17 |
| 16 | 1 | (33.6, -740.6, 561.1, 1899.5) | (33.6, 0.0, 561.1, 842.0) | ✅ | 3.14 | 16-17 |
| 17 | 1 | (33.6, -1525.6, 561.1, 1114.5) | (33.6, 0.0, 561.1, 842.0) | ✅ | 3.14 | 16-17 |
| 18 | 1 | (33.6, -2310.7, 561.1, 752.6) | (33.6, 0.0, 561.1, 752.6) | ✅ | 3.64 | 16-18 |
| 19 | 1 | (33.6, 28.8, 561.1, 509.5) | (33.6, 28.8, 561.1, 509.5) | ❌ | 0.57 | 19 |
| 20 | 1 | (33.6, 28.8, 561.1, 720.8) | (33.6, 28.8, 561.1, 720.8) | ❌ | 0.82 | 20 |
| 21 | 1 | (33.6, 28.8, 561.1, 491.5) | (33.6, 28.8, 561.1, 491.5) | ❌ | 0.55 | 21 |
| 22 | 1 | (33.6, 28.8, 561.1, 509.5) | (33.6, 28.8, 561.1, 509.5) | ❌ | 0.57 | 22 |
| 23 | 1 | (33.6, 28.8, 561.1, 394.9) | (33.6, 28.8, 561.1, 394.9) | ❌ | 0.43 | 23 |
| 23 | 2 | (33.6, 442.9, 561.1, 812.6) | (33.6, 442.9, 561.1, 812.6) | ❌ | 0.44 | 23 |
| 24 | 1 | (33.6, 73.2, 561.1, 93.0) | (33.6, 73.2, 561.1, 93.0) | ❌ | 0.02 | 24 |
| 24 | 2 | (33.6, 140.4, 561.1, 160.2) | (33.6, 140.4, 561.1, 160.2) | ❌ | 0.02 | 24 |
| 24 | 3 | (33.6, 207.7, 561.1, 2248.8) | (33.6, 207.7, 561.1, 842.0) | ✅ | 2.42 | 24-25 |
| 25 | 1 | (99.0, -17.4, 561.1, 924.2) | (99.0, 0.0, 561.1, 842.0) | ✅ | 1.12 | 25 |
| 26 | 1 | (33.6, -1245.4, 561.1, 1083.9) | (33.6, 0.0, 561.1, 842.0) | ✅ | 2.77 | 25-26 |
| 27 | 1 | (33.6, -106.2, 561.1, 433.9) | (33.6, 0.0, 561.1, 433.9) | ✅ | 0.64 | 27 |
| 27 | 2 | (33.6, 462.7, 561.1, 694.4) | (33.6, 462.7, 561.1, 694.4) | ❌ | 0.28 | 27 |


---

## 统计信息

- **总表格数**: 30
- **跨页表格**: 19 (63.3%)
- **正常表格**: 11 (36.7%)

### 跨页表格分组

通过x坐标聚合识别同一跨页表格：


**X坐标范围: (33.6, 561.1)**
- 页码: 3 ~ 27 (共28页)
- 页码列表: 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 23, 24, 24, 24, 26, 27, 27


---

## 实现建议

### 修改 

在  方法中：



### 好处

1. **保留跨页信息**:  用于跨页表格判断（hint生成）
2. **文本提取正确**:  只提取当前页面内容，避免页码标记
3. **语义清晰**:  明确标记
4. **向后兼容**: 现有代码使用  不受影响

---

*生成时间: 2025-10-29*
*PDFPlumber版本: 0.11.7*
